"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[409],{2024:function(e,t,n){function l(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),l=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+l+"-"+a}function a(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),l=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,a=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),r=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),c=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+"-"+l+"-"+a+" "+s+":"+r+":"+c}function s(e){let t=e.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,l=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!n.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const a of t){const e=a.match(n),t=a.replace(n,"");for(const n of e){const e=n.slice(1,-1).split(":");""!==t&&l.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return l.sort(((e,t)=>e[0]-t[0])),l}n.d(t,{oy:function(){return l},p6:function(){return a},zu:function(){return s}})},2448:function(e,t,n){n.d(t,{Z:function(){return b}});var l=n(3396),a=n(7139);const s=e=>((0,l.dD)("data-v-78b3d124"),e=e(),(0,l.Cn)(),e),r={class:"comment"},c={class:"comment-title"},o=s((()=>(0,l._)("span",null,"评论",-1))),u={class:"comment-desc"},i=(0,l.Uk)("发表评论"),p={class:"popular"},g={class:"popular-msg"},m={class:"name"},d={class:"time"},f={class:"content"},v=["onClick"];function y(e,t,n,s,y,h){const w=(0,l.up)("el-input"),_=(0,l.up)("el-button"),I=(0,l.up)("el-image"),D=(0,l.up)("yin-icon"),k=(0,l.up)("delete"),S=(0,l.up)("el-icon");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",r,[(0,l._)("h2",c,[o,(0,l._)("span",u,"共 "+(0,a.zw)(e.commentList.length)+" 条评论",1)]),(0,l.Wm)(w,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,l.Wm)(_,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,l.w5)((()=>[i])),_:1})]),(0,l._)("ul",p,[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.commentList,((t,n)=>((0,l.wg)(),(0,l.iD)("li",{key:n},[(0,l.Wm)(I,{class:"popular-img",fit:"contain",src:e.attachImageUrl(t.avator)},null,8,["src"]),(0,l._)("div",g,[(0,l._)("ul",null,[(0,l._)("li",m,(0,a.zw)(t.username),1),(0,l._)("li",d,(0,a.zw)(e.formatDate(t.createTime)),1),(0,l._)("li",f,(0,a.zw)(t.content),1)])]),(0,l._)("div",{ref_for:!0,ref:"up",class:"comment-ctr",onClick:l=>e.setSupport(t.id,t.up,n)},[(0,l._)("div",null,[(0,l.Wm)(D,{icon:e.iconList.Support},null,8,["icon"]),(0,l.Uk)(" "+(0,a.zw)(t.up),1)]),t.userId===e.userId?((0,l.wg)(),(0,l.j4)(S,{key:0,onClick:l=>e.deleteComment(t.id,n)},{default:(0,l.w5)((()=>[(0,l.Wm)(k)])),_:2},1032,["onClick"])):(0,l.kq)("",!0)],8,v)])))),128))])],64)}var h=n(4870),w=n(9749),_=n(547),I=n(3089),D=n(8045),k=n(2167),S=n(5478),x=n(2024),C=(0,l.aZ)({components:{YinIcon:I.Z,Delete:_.Z},props:{playId:Number||String,type:Number},setup(e){const{proxy:t}=(0,l.FN)(),n=(0,w.oR)(),{checkStatus:a}=(0,D.Z)(),{playId:s,type:r}=(0,h.BK)(e),c=(0,h.iH)([]),o=(0,h.iH)(""),u=(0,h.qj)({Support:S.JO.Support}),i=(0,l.Fl)((()=>n.getters.userId)),p=(0,l.Fl)((()=>n.getters.songId));async function g(){try{const e=await k.x.getAllComment(r.value,s.value);c.value=e.data;for(let t=0;t<c.value.length;t++){const e=await k.x.getUserOfId(c.value[t].userId);c.value[t].avator=e.data[0].avator,c.value[t].username=e.data[0].username}}catch(e){console.error(e)}}async function m(){if(!a())return;const e=new URLSearchParams;1===r.value?e.append("songListId",`${s.value}`):0===r.value&&e.append("songId",`${s.value}`),e.append("userId",i.value),e.append("type",`${r.value}`),e.append("content",o.value);const n=await k.x.setComment(e);t.$message({message:n.message,type:n.type}),n.success&&(o.value="",await g())}async function d(e,n){const l=await k.x.deleteComment(e);t.$message({message:l.message,type:l.type}),l.success&&c.value.splice(n,1)}async function f(e,t,n){if(!a())return;const l=new URLSearchParams;l.append("id",e),l.append("up",t+1);const s=await k.x.setSupport(l);s.success&&await g()}return(0,l.YP)(p,(()=>{g()})),(0,l.bv)((()=>{g()})),{userId:i,commentList:c,textarea:o,iconList:u,attachImageUrl:k.x.attachImageUrl,submitComment:m,setSupport:f,formatDate:x.p6,deleteComment:d}}}),F=n(89);const z=(0,F.Z)(C,[["render",y],["__scopeId","data-v-78b3d124"]]);var b=z},3089:function(e,t,n){n.d(t,{Z:function(){return i}});var l=n(3396);const a={class:"icon","aria-hidden":"true"},s=["xlink:href"];function r(e,t,n,r,c,o){return(0,l.wg)(),(0,l.iD)("svg",a,[(0,l._)("use",{"xlink:href":e.icon},null,8,s)])}var c=(0,l.aZ)({props:{icon:String}}),o=n(89);const u=(0,o.Z)(c,[["render",r]]);var i=u},1409:function(e,t,n){n.r(t),n.d(t,{default:function(){return S}});var l=n(3396),a=n(7139),s=n(9242);const r=e=>((0,l.dD)("data-v-a931a724"),e=e(),(0,l.Cn)(),e),c={class:"song-container"},o={class:"song-info"},u={class:"container"},i={class:"lyric-container"},p={class:"song-lyric"},g={class:"no-lyric",key:"no-lyric"},m=r((()=>(0,l._)("span",null,"暂无歌词",-1))),d=[m];function f(e,t,n,r,m,f){const v=(0,l.up)("el-image"),y=(0,l.up)("comment");return(0,l.wg)(),(0,l.iD)(l.HY,null,[(0,l._)("div",c,[(0,l.Wm)(v,{class:"song-pic",fit:"contain",src:e.attachImageUrl(e.songPic)},null,8,["src"]),(0,l._)("ul",o,[(0,l._)("li",null,"歌手："+(0,a.zw)(e.singerName),1),(0,l._)("li",null,"歌曲："+(0,a.zw)(e.songTitle),1)])]),(0,l._)("div",u,[(0,l._)("div",i,[(0,l._)("div",p,[(0,l.Wm)(s.W3,{name:"lyric-fade"},{default:(0,l.w5)((()=>[e.lyricArr.length?((0,l.wg)(),(0,l.iD)("ul",{style:(0,a.j5)({top:e.lrcTop}),class:"has-lyric",key:"has-lyric"},[((0,l.wg)(!0),(0,l.iD)(l.HY,null,(0,l.Ko)(e.lyricArr,((e,t)=>((0,l.wg)(),(0,l.iD)("li",{key:t},(0,a.zw)(e[1]),1)))),128))],4)):((0,l.wg)(),(0,l.iD)("div",g,d))])),_:1})]),(0,l.Wm)(y,{playId:e.songId,type:0},null,8,["playId"])])])],64)}var v=n(4870),y=n(9749),h=n(2448),w=n(2024),_=n(2167),I=(0,l.aZ)({components:{Comment:h.Z},setup(){const e=(0,y.oR)(),t=(0,v.iH)("80px"),n=(0,v.iH)([]),a=(0,l.Fl)((()=>e.getters.songId)),s=(0,l.Fl)((()=>e.getters.lyric)),r=(0,l.Fl)((()=>e.getters.currentPlayList)),c=(0,l.Fl)((()=>e.getters.currentPlayIndex)),o=(0,l.Fl)((()=>e.getters.curTime)),u=(0,l.Fl)((()=>e.getters.songTitle)),i=(0,l.Fl)((()=>e.getters.singerName)),p=(0,l.Fl)((()=>e.getters.songPic));return(0,l.YP)(a,(()=>{n.value=(0,w.zu)(r.value[c.value].lyric)})),(0,l.YP)(o,(()=>{if(0!==n.value.length)for(let e=0;e<n.value.length;e++)if(o.value>=n.value[e][0]){for(let e=0;e<n.value.length;e++)document.querySelectorAll(".has-lyric li")[e].style.color="#000",document.querySelectorAll(".has-lyric li")[e].style.fontSize="14px";e>=0&&(t.value=30*-e+50+"px",document.querySelectorAll(".has-lyric li")[e].style.color="#95d2f6",document.querySelectorAll(".has-lyric li")[e].style.fontSize="18px")}})),n.value=s.value?(0,w.zu)(s.value):[],{songPic:p,singerName:i,songTitle:u,lrcTop:t,lyricArr:n,songId:a,attachImageUrl:_.x.attachImageUrl}}}),D=n(89);const k=(0,D.Z)(I,[["render",f],["__scopeId","data-v-a931a724"]]);var S=k}}]);
//# sourceMappingURL=409.d17e7d86.js.map