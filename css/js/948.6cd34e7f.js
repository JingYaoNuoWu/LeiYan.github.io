"use strict";(self["webpackChunkmusic_client"]=self["webpackChunkmusic_client"]||[]).push([[948],{2024:function(e,t,n){function a(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,l=t.getDate()<10?"0"+t.getDate():t.getDate();return n+"-"+a+"-"+l}function l(e){if(null==e||""==e)return"";const t=new Date(e),n=t.getFullYear(),a=t.getMonth()+1<10?"0"+(t.getMonth()+1):t.getMonth()+1,l=t.getDate()<10?"0"+t.getDate():t.getDate(),s=t.getHours()<10?"0"+t.getHours():t.getHours(),o=t.getMinutes()<10?"0"+t.getMinutes():t.getMinutes(),u=t.getSeconds()<10?"0"+t.getSeconds():t.getSeconds();return n+"-"+a+"-"+l+" "+s+":"+o+":"+u}function s(e){let t=e.split("\n");const n=/\[\d{2}:\d{2}.(\d{3}|\d{2})\]/g,a=[];if(!/\[.+\]/.test(e))return[[0,e]];while(!n.test(t[0]))t=t.slice(1);0===t[t.length-1].length&&t.pop();for(const l of t){const e=l.match(n),t=l.replace(n,"");for(const n of e){const e=n.slice(1,-1).split(":");""!==t&&a.push([60*parseInt(e[0],10)+parseFloat(e[1]),t])}}return a.sort(((e,t)=>e[0]-t[0])),a}n.d(t,{oy:function(){return a},p6:function(){return l},zu:function(){return s}})},2448:function(e,t,n){n.d(t,{Z:function(){return W}});var a=n(3396),l=n(7139);const s=e=>((0,a.dD)("data-v-78b3d124"),e=e(),(0,a.Cn)(),e),o={class:"comment"},u={class:"comment-title"},i=s((()=>(0,a._)("span",null,"评论",-1))),c={class:"comment-desc"},r=(0,a.Uk)("发表评论"),d={class:"popular"},p={class:"popular-msg"},m={class:"name"},g={class:"time"},w={class:"content"},f=["onClick"];function v(e,t,n,s,v,h){const k=(0,a.up)("el-input"),_=(0,a.up)("el-button"),y=(0,a.up)("el-image"),I=(0,a.up)("yin-icon"),b=(0,a.up)("delete"),C=(0,a.up)("el-icon");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a._)("div",o,[(0,a._)("h2",u,[i,(0,a._)("span",c,"共 "+(0,l.zw)(e.commentList.length)+" 条评论",1)]),(0,a.Wm)(k,{class:"comment-input",type:"textarea",placeholder:"期待您的精彩评论...",rows:2,modelValue:e.textarea,"onUpdate:modelValue":t[0]||(t[0]=t=>e.textarea=t)},null,8,["modelValue"]),(0,a.Wm)(_,{class:"sub-btn",type:"primary",onClick:t[1]||(t[1]=t=>e.submitComment())},{default:(0,a.w5)((()=>[r])),_:1})]),(0,a._)("ul",d,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(e.commentList,((t,n)=>((0,a.wg)(),(0,a.iD)("li",{key:n},[(0,a.Wm)(y,{class:"popular-img",fit:"contain",src:e.attachImageUrl(t.avator)},null,8,["src"]),(0,a._)("div",p,[(0,a._)("ul",null,[(0,a._)("li",m,(0,l.zw)(t.username),1),(0,a._)("li",g,(0,l.zw)(e.formatDate(t.createTime)),1),(0,a._)("li",w,(0,l.zw)(t.content),1)])]),(0,a._)("div",{ref_for:!0,ref:"up",class:"comment-ctr",onClick:a=>e.setSupport(t.id,t.up,n)},[(0,a._)("div",null,[(0,a.Wm)(I,{icon:e.iconList.Support},null,8,["icon"]),(0,a.Uk)(" "+(0,l.zw)(t.up),1)]),t.userId===e.userId?((0,a.wg)(),(0,a.j4)(C,{key:0,onClick:a=>e.deleteComment(t.id,n)},{default:(0,a.w5)((()=>[(0,a.Wm)(b)])),_:2},1032,["onClick"])):(0,a.kq)("",!0)],8,f)])))),128))])],64)}var h=n(4870),k=n(9749),_=n(547),y=n(3089),I=n(8045),b=n(2167),C=n(5478),D=n(2024),x=(0,a.aZ)({components:{YinIcon:y.Z,Delete:_.Z},props:{playId:Number||String,type:Number},setup(e){const{proxy:t}=(0,a.FN)(),n=(0,k.oR)(),{checkStatus:l}=(0,I.Z)(),{playId:s,type:o}=(0,h.BK)(e),u=(0,h.iH)([]),i=(0,h.iH)(""),c=(0,h.qj)({Support:C.JO.Support}),r=(0,a.Fl)((()=>n.getters.userId)),d=(0,a.Fl)((()=>n.getters.songId));async function p(){try{const e=await b.x.getAllComment(o.value,s.value);u.value=e.data;for(let t=0;t<u.value.length;t++){const e=await b.x.getUserOfId(u.value[t].userId);u.value[t].avator=e.data[0].avator,u.value[t].username=e.data[0].username}}catch(e){console.error(e)}}async function m(){if(!l())return;const e=new URLSearchParams;1===o.value?e.append("songListId",`${s.value}`):0===o.value&&e.append("songId",`${s.value}`),e.append("userId",r.value),e.append("type",`${o.value}`),e.append("content",i.value);const n=await b.x.setComment(e);t.$message({message:n.message,type:n.type}),n.success&&(i.value="",await p())}async function g(e,n){const a=await b.x.deleteComment(e);t.$message({message:a.message,type:a.type}),a.success&&u.value.splice(n,1)}async function w(e,t,n){if(!l())return;const a=new URLSearchParams;a.append("id",e),a.append("up",t+1);const s=await b.x.setSupport(a);s.success&&await p()}return(0,a.YP)(d,(()=>{p()})),(0,a.bv)((()=>{p()})),{userId:r,commentList:u,textarea:i,iconList:c,attachImageUrl:b.x.attachImageUrl,submitComment:m,setSupport:w,formatDate:D.p6,deleteComment:g}}}),L=n(89);const S=(0,L.Z)(x,[["render",v],["__scopeId","data-v-78b3d124"]]);var W=S},8053:function(e,t,n){n.d(t,{Z:function(){return D}});var a=n(3396);const l={class:"content"},s=(0,a.Uk)("下载"),o=(0,a.Uk)("删除");function u(e,t,n,u,i,c){const r=(0,a.up)("el-table-column"),d=(0,a.up)("MoreFilled"),p=(0,a.up)("el-icon"),m=(0,a.up)("el-dropdown-item"),g=(0,a.up)("el-dropdown-menu"),w=(0,a.up)("el-dropdown"),f=(0,a.up)("el-table");return(0,a.wg)(),(0,a.iD)("div",l,[(0,a.Wm)(f,{"highlight-current-row":"",data:e.dataList,onRowClick:e.handleClick},{default:(0,a.w5)((()=>[(0,a.Wm)(r,{prop:"songName",label:"歌曲"}),(0,a.Wm)(r,{prop:"singerName",label:"歌手"}),(0,a.Wm)(r,{prop:"introduction",label:"专辑"}),(0,a.Wm)(r,{label:"编辑",width:"80",align:"center"},{default:(0,a.w5)((t=>[(0,a.Wm)(w,null,{dropdown:(0,a.w5)((()=>[(0,a.Wm)(g,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{icon:e.Download,onClick:n=>e.downloadMusic({songUrl:t.row.url,songName:t.row.name})},{default:(0,a.w5)((()=>[s])),_:2},1032,["icon","onClick"]),e.show?((0,a.wg)(),(0,a.j4)(m,{key:0,icon:e.Delete,onClick:n=>e.deleteCollection({id:t.row.id})},{default:(0,a.w5)((()=>[o])),_:2},1032,["icon","onClick"])):(0,a.kq)("",!0)])),_:2},1024)])),default:(0,a.w5)((()=>[(0,a.Wm)(p,{onClick:n=>e.handleEdit(t.row)},{default:(0,a.w5)((()=>[(0,a.Wm)(d)])),_:2},1032,["onClick"])])),_:2},1024)])),_:1})])),_:1},8,["data","onRowClick"])])}var i=n(4870),c=n(9749),r=n(8045),d=n(9092),p=n(547),m=n(6854);const g=(0,a.aZ)({name:"Download"}),w={class:"icon",width:"200",height:"200",viewBox:"0 0 1024 1024",xmlns:"http://www.w3.org/2000/svg"},f=(0,a._)("path",{fill:"currentColor",d:"M160 832h704a32 32 0 110 64H160a32 32 0 110-64zm384-253.696l236.288-236.352 45.248 45.248L508.8 704 192 387.2l45.248-45.248L480 584.704V128h64v450.304z"},null,-1),v=[f];function h(e,t,n,l,s,o){return(0,a.wg)(),(0,a.iD)("svg",w,v)}var k=(0,m.Z)(g,[["render",h]]),_=n(2167),y=n(5478),I=(0,a.aZ)({components:{MoreFilled:d.Z},props:{songList:Array,show:{default:!1}},emits:["changeData"],setup(e){const{getSongTitle:t,getSingerName:n,playMusic:l,checkStatus:s,downloadMusic:o}=(0,r.Z)(),{proxy:u}=(0,a.FN)(),d=(0,c.oR)(),{songList:m}=(0,i.BK)(e),g=(0,i.qj)({dislike:y.JO.Dislike,like:y.JO.Like}),w=(0,a.Fl)((()=>d.getters.songUrl)),f=(0,a.Fl)((()=>d.getters.singerName)),v=(0,a.Fl)((()=>d.getters.songTitle)),h=(0,a.Fl)((()=>{const e=[];return m.value.forEach(((a,l)=>{a["songName"]=t(a.name),a["singerName"]=n(a.name),a["index"]=l,e.push(a)})),e}));function I(e){l({id:e.id,url:e.url,pic:e.pic,index:e.index,name:e.name,lyric:e.lyric,currentSongList:m.value})}function b(e){console.log("row",e)}const C=(0,a.Fl)((()=>d.getters.userId));async function D({id:e}){if(!s())return;const t=await _.x.deleteCollection(C.value,e);u.$message({message:t.message,type:t.type}),!1===t.data&&u.$emit("changeData",t.data)}return{dataList:h,iconList:g,Delete:p.Z,Download:k,songUrl:w,singerName:f,songTitle:v,handleClick:I,handleEdit:b,downloadMusic:o,deleteCollection:D}}}),b=n(89);const C=(0,b.Z)(I,[["render",u],["__scopeId","data-v-fd83827a"]]);var D=C},3089:function(e,t,n){n.d(t,{Z:function(){return r}});var a=n(3396);const l={class:"icon","aria-hidden":"true"},s=["xlink:href"];function o(e,t,n,o,u,i){return(0,a.wg)(),(0,a.iD)("svg",l,[(0,a._)("use",{"xlink:href":e.icon},null,8,s)])}var u=(0,a.aZ)({props:{icon:String}}),i=n(89);const c=(0,i.Z)(u,[["render",o]]);var r=c},1948:function(e,t,n){n.r(t),n.d(t,{default:function(){return _}});var a=n(3396),l=n(7139);const s=e=>((0,a.dD)("data-v-386e32ba"),e=e(),(0,a.Cn)(),e),o={class:"album-info"},u=s((()=>(0,a._)("h1",null,"简介",-1))),i={class:"album-score"},c=s((()=>(0,a._)("h3",null,"歌单评分",-1)));function r(e,t,n,s,r,d){const p=(0,a.up)("el-image"),m=(0,a.up)("el-aside"),g=(0,a.up)("el-rate"),w=(0,a.up)("song-list"),f=(0,a.up)("comment"),v=(0,a.up)("el-main"),h=(0,a.up)("el-container");return(0,a.wg)(),(0,a.j4)(h,null,{default:(0,a.w5)((()=>[(0,a.Wm)(m,{class:"album-slide"},{default:(0,a.w5)((()=>[(0,a.Wm)(p,{class:"album-img",fit:"contain",src:e.attachImageUrl(e.songDetails.pic)},null,8,["src"]),(0,a._)("h3",o,(0,l.zw)(e.songDetails.title),1)])),_:1}),(0,a.Wm)(v,{class:"album-main"},{default:(0,a.w5)((()=>[u,(0,a._)("p",null,(0,l.zw)(e.songDetails.introduction),1),(0,a._)("div",i,[(0,a._)("div",null,[c,(0,a.Wm)(g,{modelValue:e.rank,"onUpdate:modelValue":t[0]||(t[0]=t=>e.rank=t),"allow-half":"",disabled:""},null,8,["modelValue"])]),(0,a._)("span",null,(0,l.zw)(2*e.rank),1),(0,a._)("div",null,[(0,a._)("h3",null,(0,l.zw)(e.assistText)+" "+(0,l.zw)(2*e.score),1),(0,a.Wm)(g,{"allow-half":"",modelValue:e.score,"onUpdate:modelValue":t[1]||(t[1]=t=>e.score=t),disabled:e.disabledRank,onClick:t[2]||(t[2]=t=>e.pushValue())},null,8,["modelValue","disabled"])])]),(0,a.Wm)(w,{class:"album-body",songList:e.currentSongList},null,8,["songList"]),(0,a.Wm)(f,{playId:e.songListId,type:1},null,8,["playId"])])),_:1})])),_:1})}var d=n(4870),p=n(9749),m=n(8045),g=n(8053),w=n(2448),f=n(2167),v=(0,a.aZ)({components:{SongList:g.Z,Comment:w.Z},setup(){const{proxy:e}=(0,a.FN)(),t=(0,p.oR)(),{checkStatus:n}=(0,m.Z)(),l=(0,d.iH)([]),s=(0,d.iH)(""),o=(0,d.iH)(0),u=(0,d.iH)(0),i=(0,d.iH)(!1),c=(0,d.iH)("评价"),r=(0,a.Fl)((()=>t.getters.songDetails)),g=(0,a.Fl)((()=>t.getters.userId));async function w(e){const t=await f.x.getListSongOfSongId(e);for(const n of t.data){const e=await f.x.getSongOfId(n.songId);l.value.push(e.data[0])}}async function v(e){const t=await f.x.getRankOfSongListId(e);u.value=t.data/2}async function h(e,t){const n=await f.x.getUserRank(e,t);o.value=n.data/2,i.value=!0,c.value="已评价"}async function k(){if(i.value||!n())return;const t=new URLSearchParams;t.append("songListId",s.value),t.append("consumerId",g.value),t.append("score",(2*o.value).toString());try{const n=await f.x.setRank(t);e.$message({message:n.message,type:n.type}),n.success&&(v(s.value),i.value=!0,c.value="已评价")}catch(a){console.error(a)}}return s.value=r.value.id,h(g.value,s.value),v(s.value),w(s.value),{songDetails:r,rank:u,score:o,disabledRank:i,assistText:c,currentSongList:l,songListId:s,attachImageUrl:f.x.attachImageUrl,pushValue:k}}}),h=n(89);const k=(0,h.Z)(v,[["render",r],["__scopeId","data-v-386e32ba"]]);var _=k}}]);
//# sourceMappingURL=948.6cd34e7f.js.map